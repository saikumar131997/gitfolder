<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Widget Initialization</title>
</head>
<body>
    <script>
  var initESW = function(gslbBaseURL) {
        embedded_svc.settings.displayHelpButton = true; //Or false
        embedded_svc.settings.language = ''; //For example, enter 'en' or 'en-US'

        embedded_svc.settings.defaultMinimizedText = 'CHAT'; //(Defaults to Chat with an Expert)
        embedded_svc.settings.disabledMinimizedText = 'AGENT OFFLINE'; //(Defaults to Agent Offline)

        embedded_svc.settings.loadingText = 'Loading'; //(Defaults to Loading) 
        //embedded_svc.settings.storageDomain = 'yourdomain.com'; //(Sets the domain for your deployment so that visitors can navigate subdomains during a chat session)

       embedded_svc.settings.extraPrechatFormDetails = [
       {"label": "preChatQuestion", "transcriptFields": ["PreChat_Question__c"]},{"label":"claimNumber", "transcriptFields": ["Claim__c"]},{"label":"policyNumber", "transcriptFields": ["Policy__c"]},{"label":"so", "transcriptFields": ["SO__c"]},{"label":"queryType", "transcriptFields": ["Query_Type__c"]}, {"label":"subTypeOfQuery", "transcriptFields": ["Sub_Query_Type__c"]}, {"label":"referenceSite", "transcriptFields": ["ReferrerUri"]}, {"label":"chatType", "transcriptFields": ["CSP_Chat_Type__c"]}// some random field
        ];

       document.addEventListener(
       "preChattoContainer",
       function (event) {
       embedded_svc.settings.extraPrechatFormDetails[0].value = event.detail.preChatQuestion;
       embedded_svc.settings.extraPrechatFormDetails[1].value = event.detail.claimNumber;
       embedded_svc.settings.extraPrechatFormDetails[2].value = event.detail.policyNumber;
       embedded_svc.settings.extraPrechatFormDetails[3].value = event.detail.so;
       embedded_svc.settings.extraPrechatFormDetails[4].value = event.detail.queryType;
       embedded_svc.settings.extraPrechatFormDetails[5].value = event.detail.subTypeOfQuery;
       embedded_svc.settings.extraPrechatFormDetails[6].value = event.detail.referenceSite;
       embedded_svc.settings.extraPrechatFormDetails[7].value = event.detail.chatType;
       },
       
       false
       );
       
        // Settings for Chat
        //embedded_svc.settings.directToButtonRouting = function(prechatFormData) {
            // Dynamically changes the button ID based on what the visitor enters in the pre-chat form.
            // Returns a valid button ID.
        //};
        //embedded_svc.settings.prepopulatedPrechatFields = {}; //Sets the auto-population of pre-chat form fields
        //embedded_svc.settings.fallbackRouting = []; //An array of button IDs, user IDs, or userId_buttonId
        //embedded_svc.settings.offlineSupportMinimizedText = '...'; //(Defaults to Contact Us)

        embedded_svc.settings.enabledFeatures = ['LiveAgent'];
        embedded_svc.settings.entryFeature = 'LiveAgent';

        embedded_svc.init(
            'https://farmers--efnolsit1.sandbox.my.salesforce.com',
            'https://claims.app.trytoyotaautoinsurance.com/cmp',
            gslbBaseURL,
            '00D7e00000JggbJ',
            'Farmers_Snap_Ins_Chat',
            {
                baseLiveAgentContentURL: 'https://c.la3-c1cs-ia4.salesforceliveagent.com/content',
                deploymentId: '5727e000000H0GE',
                buttonId: '5737e000000H0fP',
                baseLiveAgentURL: 'https://d.la3-c1cs-ia4.salesforceliveagent.com/chat',
                eswLiveAgentDevName: 'EmbeddedServiceLiveAgent_Parent04I7e000000GnVWEA0_18f1efcc3e1',
                isOfflineSupportEnabled: false
            }
        );
    };

    if (!window.embedded_svc) {
        var s = document.createElement('script');
        s.setAttribute('src', 'https://farmers--efnolsit1.sandbox.my.salesforce.com/embeddedservice/5.0/esw.min.js');
        s.onload = function() {
            initESW(null);
        };
        document.body.appendChild(s);
    } else {
        initESW('https://service.force.com');
    }
    </script>
</body>
</html>
